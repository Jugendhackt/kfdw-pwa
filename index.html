<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes">
	<title>Kot für die Welt</title>
	<meta name="robots" content="noindex,follow">
	<link rel="stylesheet" href="static/css/app.css" type="text/css">
	<base href="/kfdw-pwa/">
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
</head>
<body>
	<header>
		<h1 class="title">KfdW PWA</h1>
		<button id="butSettings" class="headerButton" aria-label="Settings"></button>
		<button id="butHighscore" class="headerButton" aria-label="Highscore"></button>
	</header>
	<main>
		<p>Auf dieser Karte sind Pinnadeln, welche Müll darstellen.</p>
		<div id="mapid"></div>
	</main>
	<script>
	function initMap() {
		var data = getPointData(1)
		if(data == false) {
			alert("Data could not load!");
		}
		var mymap = L.map('mapid').setView([data.lat, data.lng], 13);


		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
				'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
			id: 'mapbox.streets'
		}).addTo(mymap);

		function onLocationFound(e) {
			var radius = e.accuracy / 2; //vorher 2

			L.marker(e.latlng).addTo(mymap)
				.bindPopup("Standort auf " + radius + "m genau.").openPopup();

			L.circle(e.latlng, radius).addTo(mymap);
		}

		function onLocationError(e) {
			alert(e.message);
		}

		mymap.on('locationfound', onLocationFound);
		mymap.on('locationerror', onLocationError);

		mymap.locate({setView: true, maxZoom: 16});

		setMarkersFromLocations(mymap);

	}
  </script>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
	<script src="static/js/app.js" onload="javascript:initMap();"></script>
	<script src="static/js/init.js"></script>
</body>
</html>
